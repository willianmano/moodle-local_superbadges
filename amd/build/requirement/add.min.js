define("local_superbadges/requirement/add",["exports","jquery","core_form/modalform","core/str","./repository","local_superbadges/notification"],(function(_exports,_jquery,_modalform,_str,_repository,_notification){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=_interopRequireDefault(_jquery),_modalform=_interopRequireDefault(_modalform),_notification=_interopRequireDefault(_notification);_exports.init=(trigger,courseid,badgeid)=>{document.querySelectorAll(trigger).forEach((target=>target.addEventListener("click",(event=>{event.preventDefault(),openModal(event.target.dataset.key,courseid,badgeid)}))))};const openModal=async(method,courseid,badgeid)=>{let formClass="superbadgesrequirement_".concat(method,"\\form\\requirement");const modal=new _modalform.default({formClass:formClass,args:{formdata:{courseid:courseid,badgeid:badgeid,method:method}},saveButtonText:(0,_str.get_string)("addrequirement","local_superbadges"),modalConfig:{title:(0,_str.get_string)("addrequirement","local_superbadges")}});modal.addEventListener(modal.events.FORM_SUBMITTED,(event=>{submitFormAjax(event.detail)})),modal.show()},submitFormAjax=async formdata=>{try{let response=await(0,_repository.addRequirement)(formdata);(0,_notification.default)(response.message);let data=JSON.parse(response.data);addRequirementToTable(data)}catch(e){return(0,_notification.default)(e.message,"error"),!1}},addRequirementToTable=data=>{var _data$target;let target=null!==(_data$target=data.target)&&void 0!==_data$target?_data$target:data.target="";(0,_jquery.default)('<tr><th scope="row">'+data.id+"</th><td>"+data.pluginname+"</td><td>"+target+"</td><td>"+data.value+'</td><td style="width: 120px; text-align: center;"><a href="#" data-id="'+data.id+'" class="btn btn-danger btn-sm delete-requirement"><i class="fa fa-trash-o"></i></a> </td></tr>').appendTo(".table-requirements tbody").hide().fadeIn("normal")}}));

//# sourceMappingURL=add.min.js.map