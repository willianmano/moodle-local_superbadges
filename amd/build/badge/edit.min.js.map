{"version":3,"file":"edit.min.js","sources":["../../src/badge/edit.js"],"sourcesContent":["import $ from 'jquery';\nimport ModalForm from 'core_form/modalform';\nimport {get_string as getString} from 'core/str';\nimport showNotification from 'local_superbadges/notification';\n\n/* eslint-disable */\nlet eventTarget;\n\nexport const init = (selector, courseid) => {\n    $(\"body\").on(\"click\", selector, function(event) {\n        event.preventDefault();\n\n        eventTarget = $(event.currentTarget);\n\n        openModal();\n    });\n};\n\nconst openModal = () => {\n    let formClass = 'local_superbadges\\\\forms\\\\badge';\n\n    const modal = new ModalForm({\n        formClass,\n        args: {formdata: {\n            id: eventTarget.data('id'),\n            courseid: eventTarget.data('courseid'),\n            badgeid: eventTarget.data('badgeid'),\n            name: eventTarget.data('name'),\n            description: eventTarget.data('description'),\n        }},\n        saveButtonText: getString('editbadge', 'local_superbadges'),\n        modalConfig: {\n            title: getString('editbadge', 'local_superbadges'),\n        }\n    });\n\n    modal.addEventListener(modal.events.FORM_SUBMITTED, (event) => {\n        if (event.detail.message) {\n            showNotification(event.detail.message);\n\n            let data = JSON.parse(event.detail.data);\n\n            return changeTableRowData(data);\n        } else {\n            const warningMessages = event.detail.warnings.map(warning => warning.message);\n\n            showNotification(warningMessages.join('<br>'), 'error');\n        }\n    });\n\n    modal.show();\n};\n\nconst changeTableRowData = (data) => {\n    const tablenamecolumn = eventTarget.closest('tr').find('td:first');\n\n    tablenamecolumn.html(data.name);\n\n    eventTarget.data('name', data.name);\n    eventTarget.data('description', data.description);\n\n    eventTarget.closest('tr').hide('normal').show('normal');\n};\n"],"names":["eventTarget","selector","courseid","on","event","preventDefault","currentTarget","openModal","modal","ModalForm","formClass","args","formdata","id","data","badgeid","name","description","saveButtonText","modalConfig","title","addEventListener","events","FORM_SUBMITTED","detail","message","JSON","parse","changeTableRowData","warningMessages","warnings","map","warning","join","show","closest","find","html","hide"],"mappings":"6QAMIA,iPAEgB,CAACC,SAAUC,gCACzB,QAAQC,GAAG,QAASF,UAAU,SAASG,OACrCA,MAAMC,iBAENL,aAAc,mBAAEI,MAAME,eAEtBC,sBAIFA,UAAY,WAGRC,MAAQ,IAAIC,mBAAU,CACxBC,UAHY,kCAIZC,KAAM,CAACC,SAAU,CACbC,GAAIb,YAAYc,KAAK,MACrBZ,SAAUF,YAAYc,KAAK,YAC3BC,QAASf,YAAYc,KAAK,WAC1BE,KAAMhB,YAAYc,KAAK,QACvBG,YAAajB,YAAYc,KAAK,iBAElCI,gBAAgB,mBAAU,YAAa,qBACvCC,YAAa,CACTC,OAAO,mBAAU,YAAa,wBAItCZ,MAAMa,iBAAiBb,MAAMc,OAAOC,gBAAiBnB,WAC7CA,MAAMoB,OAAOC,QAAS,2BACLrB,MAAMoB,OAAOC,aAE1BX,KAAOY,KAAKC,MAAMvB,MAAMoB,OAAOV,aAE5Bc,mBAAmBd,MACvB,OACGe,gBAAkBzB,MAAMoB,OAAOM,SAASC,KAAIC,SAAWA,QAAQP,oCAEpDI,gBAAgBI,KAAK,QAAS,aAIvDzB,MAAM0B,QAGJN,mBAAsBd,OACAd,YAAYmC,QAAQ,MAAMC,KAAK,YAEvCC,KAAKvB,KAAKE,MAE1BhB,YAAYc,KAAK,OAAQA,KAAKE,MAC9BhB,YAAYc,KAAK,cAAeA,KAAKG,aAErCjB,YAAYmC,QAAQ,MAAMG,KAAK,UAAUJ,KAAK"}