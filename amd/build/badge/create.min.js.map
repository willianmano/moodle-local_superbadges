{"version":3,"file":"create.min.js","sources":["../../src/badge/create.js"],"sourcesContent":["import $ from 'jquery';\nimport ModalForm from 'core_form/modalform';\nimport {get_string as getString} from 'core/str';\nimport showNotification from 'local_superbadges/notification';\nimport Config from 'core/config';\n\n/* eslint-disable */\nexport const init = (selector, courseid) => {\n    document.querySelectorAll(selector).forEach(target =>\n        target.addEventListener('click', (event) => {\n            event.preventDefault();\n\n            openModal(courseid);\n        })\n    );\n};\n\nconst openModal = async (courseid) => {\n    let formClass = 'local_superbadges\\\\forms\\\\badge';\n\n    const modal = new ModalForm({\n        formClass,\n        args: {formdata: {courseid: courseid}},\n        saveButtonText: getString('createbadge', 'local_superbadges'),\n        modalConfig: {\n            title: getString('createbadge', 'local_superbadges'),\n        }\n    });\n\n    modal.addEventListener(modal.events.FORM_SUBMITTED, (event) => {\n        if (event.detail.message) {\n            showNotification(event.detail.message);\n\n            let data = JSON.parse(event.detail.data);\n\n            return addBadgeToTable(data);\n        } else {\n            const warningMessages = event.detail.warnings.map(warning => warning.message);\n            Notification.addNotification({\n                type: 'error',\n                message: warningMessages.join('<br>')\n            });\n        }\n    });\n\n    modal.show();\n};\n\nconst addBadgeToTable = (data) => {\n    let tableLine = $('<tr>' +\n        '<th scope=\"row\">' + data.id + '</th>' +\n        '<td>' + data.name + '</td>' +\n        '<td style=\"width: 200px; text-align: center;\">' +\n        '<a href=\"#\" data-id=\"' + data.id + '\" class=\"btn btn-info btn-sm deliver-badge\">' +\n        '<i class=\"fa fa-paper-plane-o\"></i>' +\n        '</a> ' +\n        '<a href=\"' + Config.wwwroot + '/local/superbadges/requirements.php?id=' +\n        data.id + '\" data-id=\"' + data.id + '\" ' +\n        'class=\"btn btn-primary btn-sm\"><i class=\"fa fa-list\"></i></a>' +\n        '</a> ' +\n        '<a href=\"#\" data-id=\"' + data.id + '\" data-name=\"' + data.name + '\"' +\n        ' data-description=\"' + data.description + '\"' +\n        ' data-courseid=\"' + data.courseid + '\" data-badgeid=\"' + data.badgeid + '\"' +\n        ' class=\"btn btn-warning btn-sm edit-badge\">' +\n        '<i class=\"fa fa-pencil-square-o text-white\"></i>' +\n        '</a> ' +\n        '<a href=\"#\" data-id=\"' + data.id + '\" class=\"btn btn-danger btn-sm delete-badge\">' +\n        '<i class=\"fa fa-trash-o\"></i>' +\n        '</a> ' +\n        '</td>' +\n        '</tr>');\n\n    tableLine\n        .appendTo('.table-badges tbody')\n        .hide().fadeIn('normal');\n};\n"],"names":["selector","courseid","document","querySelectorAll","forEach","target","addEventListener","event","preventDefault","openModal","async","modal","ModalForm","formClass","args","formdata","saveButtonText","modalConfig","title","events","FORM_SUBMITTED","detail","message","data","JSON","parse","addBadgeToTable","warningMessages","warnings","map","warning","Notification","addNotification","type","join","show","id","name","Config","wwwroot","description","badgeid","appendTo","hide","fadeIn"],"mappings":"8iBAOoB,CAACA,SAAUC,YAC3BC,SAASC,iBAAiBH,UAAUI,SAAQC,QACxCA,OAAOC,iBAAiB,SAAUC,QAC9BA,MAAMC,iBAENC,UAAUR,sBAKhBQ,UAAYC,MAAAA,iBAGRC,MAAQ,IAAIC,mBAAU,CACxBC,UAHY,kCAIZC,KAAM,CAACC,SAAU,CAACd,SAAUA,WAC5Be,gBAAgB,mBAAU,cAAe,qBACzCC,YAAa,CACTC,OAAO,mBAAU,cAAe,wBAIxCP,MAAML,iBAAiBK,MAAMQ,OAAOC,gBAAiBb,WAC7CA,MAAMc,OAAOC,QAAS,2BACLf,MAAMc,OAAOC,aAE1BC,KAAOC,KAAKC,MAAMlB,MAAMc,OAAOE,aAE5BG,gBAAgBH,MACpB,OACGI,gBAAkBpB,MAAMc,OAAOO,SAASC,KAAIC,SAAWA,QAAQR,UACrES,aAAaC,gBAAgB,CACzBC,KAAM,QACNX,QAASK,gBAAgBO,KAAK,cAK1CvB,MAAMwB,QAGJT,gBAAmBH,QACL,mBAAE,uBACOA,KAAKa,GADZ,YAELb,KAAKc,KAFA,2EAIYd,KAAKa,GAJjB,gGAOAE,gBAAOC,QAAU,0CAC/BhB,KAAKa,GAAK,cAAgBb,KAAKa,GARjB,4FAWYb,KAAKa,GAAK,gBAAkBb,KAAKc,KAX7C,uBAYUd,KAAKiB,YAZf,oBAaOjB,KAAKtB,SAAW,mBAAqBsB,KAAKkB,QAbjD,yHAiBYlB,KAAKa,GAjBjB,6FAwBbM,SAAS,uBACTC,OAAOC,OAAO"}