{"version":3,"file":"create.min.js","sources":["../../src/badge/create.js"],"sourcesContent":["import $ from 'jquery';\nimport ModalForm from 'core_form/modalform';\nimport {get_string as getString} from 'core/str';\nimport showNotification from 'local_superbadges/notification';\nimport Templates from 'core/templates';\n\nexport const init = (selector, courseid) => {\n    document.querySelectorAll(selector).forEach(target =>\n        target.addEventListener('click', (event) => {\n            event.preventDefault();\n\n            openModal(courseid);\n        })\n    );\n};\n\nconst openModal = async (courseid) => {\n    let formClass = 'local_superbadges\\\\forms\\\\badge';\n\n    const modal = new ModalForm({\n        formClass,\n        args: {formdata: {courseid: courseid}},\n        saveButtonText: getString('createbadge', 'local_superbadges'),\n        modalConfig: {\n            title: getString('createbadge', 'local_superbadges'),\n        }\n    });\n\n    modal.addEventListener(modal.events.FORM_SUBMITTED, (event) => {\n        if (event.detail.message) {\n            showNotification(event.detail.message);\n\n            let data = JSON.parse(event.detail.data);\n\n            return addBadgeToTable(data);\n        } else {\n            const warningMessages = event.detail.warnings.map(warning => warning.message);\n\n            showNotification(warningMessages.join('<br>'), 'error');\n        }\n    });\n\n    modal.show();\n};\n\nconst addBadgeToTable = async (data) => {\n\n    let tableLine = await Templates.render('local_superbadges/badge_tableline', data);\n\n    $('.table-badges tbody').append(tableLine).hide().fadeIn();\n};\n"],"names":["selector","courseid","document","querySelectorAll","forEach","target","addEventListener","event","preventDefault","openModal","async","modal","ModalForm","formClass","args","formdata","saveButtonText","modalConfig","title","events","FORM_SUBMITTED","detail","message","data","JSON","parse","addBadgeToTable","warningMessages","warnings","map","warning","join","show","tableLine","Templates","render","append","hide","fadeIn"],"mappings":"0jBAMoB,CAACA,SAAUC,YAC3BC,SAASC,iBAAiBH,UAAUI,SAAQC,QACxCA,OAAOC,iBAAiB,SAAUC,QAC9BA,MAAMC,iBAENC,UAAUR,sBAKhBQ,UAAYC,MAAAA,iBAGRC,MAAQ,IAAIC,mBAAU,CACxBC,UAHY,kCAIZC,KAAM,CAACC,SAAU,CAACd,SAAUA,WAC5Be,gBAAgB,mBAAU,cAAe,qBACzCC,YAAa,CACTC,OAAO,mBAAU,cAAe,wBAIxCP,MAAML,iBAAiBK,MAAMQ,OAAOC,gBAAiBb,WAC7CA,MAAMc,OAAOC,QAAS,2BACLf,MAAMc,OAAOC,aAE1BC,KAAOC,KAAKC,MAAMlB,MAAMc,OAAOE,aAE5BG,gBAAgBH,MACpB,OACGI,gBAAkBpB,MAAMc,OAAOO,SAASC,KAAIC,SAAWA,QAAQR,oCAEpDK,gBAAgBI,KAAK,QAAS,aAIvDpB,MAAMqB,QAGJN,gBAAkBhB,MAAAA,WAEhBuB,gBAAkBC,mBAAUC,OAAO,oCAAqCZ,0BAE1E,uBAAuBa,OAAOH,WAAWI,OAAOC"}